<santa xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="santa.xsd">

        <replicates>1</replicates>

        <simulation>

            <genome>
                <length>4083</length>
	            <sequences>
	            ATGTTTTTGATACTTTTAATTTCCTTACCAACGGCTTTTGCTGTTATAGGAGATTTAAAGTGTCCTTTAGATACTAGTTATATTAATAATAAAGACACCGGTCCTCCTTTTATAAGTACTGATACTGTTGATGTTACTAATGGTTTGGGTACTTATTATGTTTTAGATCGTGTGTATTTAAATACTACGTTGTTTCTTAATGGTTATTACCCTACTTCAGGTTCCACATATCGTAATATGGCACTGAAGGGAACTGACAAATTGAGCACACTATGGTTTAAACCACCATTTCTTTCTGATTTTATTAATGGTATTTTTGCTAAGGTCAAAAATACCAAGGTTTTTAAAGATGGTGTAATGTATAGTGAGTTCCCTGCTATAACTATAGGTAGTACTTTTGTAAATACATCCTATAGTGTGGTAGTACAACCACGTACAATTAATTCAACACAGGATGGTGATAATAAATTACAAGGTCTTTTAGAGGTCTCTGTTTGCCAGTATAATATGTGCGAGTACCCACATACGATTTGTCATCCTAAACTGGGTAATCACTTCAAAGAACTATGGCATTTGGATACAGGTGTTGTTTCCTGTTTATATAAGCGTAATTTCACATATGATGTGAATGCTAATTATTTGTATTTTCATTTTTATCAAGAAGGTGGTACTTTTTATGCATATTTTACAGACACTGGTGTTGTTACTAAGTTTTTGTTTAATGTTTATTTAGGCATGGCACTTTCACACTATTATGTCATGCCTCTGACTTGTATTAGTAGGCGTGATATTGGTTTTACTTTAGAATATTGGGTTACACCCCTCACTTCTAGACAATATTTACTCGCTTTCAATCAAGATGGTATTATTTTTAATGCTGTTGATTGTATGAGTGATTTTATGAGTGAGATTAAGTGTAAAACACAATCTATAGCACCACCTACTGGTGTTTATGAATTAAACGGTTACACTGTTCAGCCAATCGCAGATGTTTACCGACGCAAACCTGATCTTCCCAATTGCAATATAGAAGCTTGGCTTAATGATAAGTCGGTGCCCTCTCCATTAAATTGGGAACGTAAGACATTTTCAAATTGTAATTTTAATATGAGCAGCCTGATGTCTTTTATTCAGGCAGACTCATTTACTTGTAATAATATTGATGCTGCTAAGATATATGGTATGTGTTTTTCCAGCATAACTATAGATAAGTTTGCTATACCCAATGGCAGGAAGGTTGACCTACAATTGGGTAATTTGGGCTATTTGCAGTCATCCAACTATAGAATTGATACTACTGCAACAAGTTGTCAGTTGTATTATAATTTACCTGCTGCTAATGTCTCTGTTAGCAGGTTTAATCCTTCTACTTGGAATAAGAGATTTGGTTTTATAGAAGATTCTGTTTTTGTGCCTCAACCTACAGGTGTTTTTACTAATCACAGTGTAGTTTATGCACAACACTGTTTCAAAGCCCCTAAAAATTTCTGTCCGTGTAAATTGAATGGTTCGTGGGTAGGTAGTGGTCCTGGTAAAAATAATGGTATAGGCACTTGTCCTGCAGGTACTAATTATTTAACTTGTGATAATTTGTGTACTCTTGATCCTATTACATTTAAAGCTCCAGGTACTTATAAGTGCCCCCAAACTAAATCTTTAGTTGGCATAGGTGAGCACTGTTCGGGTCTTGCTGTTAAAAGTGATTATTGTGGAGGCAATTCTTGTACTTGCCAACCACAAGCATTTTTGGGTTGGTCTGCAGACTCTTGTTTACAAGGAGACAAGTGTAATATTTTTGCTAATCTTATTTTGCATGATGTTAATAGTGGTCTTACTTGTTCTACTGATTTACAAAAAGCTAACACAGACATAATTCTTGGTGTTTGTGTTAATTATGACCTCTATGGTATTTCAGGCCAAGGCATTTTTGTTGAGGTTAATGCGACTTATTATAATAGTTGGCAGAACCTTTTATATGATTCTAATGGTAATCTCTACGGTTTTAGAGACTACATAACAAACAGAACTTTTATGATTCGTAGTTGCTATAGCGGTCGTGTTTCTGCGGCCTTTCATGCTAACTCTTCCGAACCAGCATTGCTATTTCGGAATATTAAATGCAACTACGTTTTTAATAATAGTCTTACACGACAGCTGCAACCCATTAACTATTTTGATAGTTATCTTGGTTGTGTTGTCAATGCTTATAATAGTACTGCTATTTCTGTTCAAACATGTGATCTCACAGTAGGTAGTGGTTACTGTGTGGATTACTCTAAAAACAGACGAAGTCGTAGAGCGATTACCACTGGTTATCGGTTTACTAATTTTGAGCCATTTACTGTTAATTCAGTAAATGATAGTTTGGAACCTGTAGGTGGTTTGTATGAAATTCAAATACCTTCAGAGTTTACTATAGGTAATATGGAGGAGTTTATTCAAACAAGCTCTCCCAAAGTTACTATTGATTGTGCTGCATTTGTCTGTGGTGATTATGCAGCATGTAAATTACAGTTGGTTGAATATGGTAGTTTCTGTGATAACATTAATGCCATACTCACAGAAGTAAATGAACTACTTGATACTACACAGTTGCAAGTAGCTAATAGTTTAATGAATGGTGTTACTCTTAGCACTAAGCTTAAAGATGGTGTTAATTTCAATGTAGACGACATCAATTTTTCCCCTGTATTAGGTTGTCTAGGCAGCGAATGTAGTAAAGCTTCCAGTAGATCTGCTATAGAGGATTTACTTTTTGATAAAGTAAAGTTATCTGATGTCGGTTTCGTTGAGGCTTATAATAATTGTACAGGAGGTGCCGAAATTAGGGACCTCATTTGTGTGCAAAGTTATAAAGGCATCAAAGTGTTGCCCCCACTGCTCTCAGAAAATCAGATCAGTGGATACACTTTGGCTGCCACCTCTGCTAGTCTATTTCCTCCTTGGACAGCAGCAGCAGGTGTACCATTTTATTTAAATGTTCAGTATCGCATTAATGGGCTTGGTGTCACCATGGATGTGCTAAGTCAAAATCAAAAGCTTATTGCTAATGCATTTAACAATGCCCTTTATGCTATTCAGCAAGGGTTCGATGCAACTAATTCTGCTTTAGTTAAAATTCAAGCTGTTGTTAATGCAAATGCTGAAGCTCTTAATAACTTATTGCAACAACTCTCTAATAGATTTGGTGCTATAAGTGCTTCTTTACAAGAAATTCTATCTAGACTTGATGCTCTTGAAGCGGAAGCTCAGATAGATAGACTTATTAATGGTCGTCTCACCGCTCTTAATGCTTATGTTTCTCAACAGCTTAGTGATTCTACACTGGTAAAATTTAGTGCAGCACAAGCTATGGAGAAGGTTAATGAATGTGTCAAAAGCCAATCATCTAGGATAAATTTCTGTGGTAATGGTAATCATATTATATCATTAGTGCAGAATGCTCCATATGGTTTGTATTTTATCCACTTTAATTATGTCCCTACTAAGTATGTCACAGCGAAGGTTAGTCCTGGTCTGTGCATTGCTGGTAATAGAGGTATAGCTCCTAAGAGTGGTTATTTTGTTAATGTAAATAATACTTGGATGTACACTGGTAGTGGTTACTACTACCCTGAACCTATAACTGAAAATAATGTTGTTGTTATGAGTACCTGCGCTGTTAATTATACTAAAGCGCCGTATGTAATGCTGAACACTTCAATACCCAACCTTCCTGATTTTAAGGAAGAGTTGGATCAATGGTTTAAAAATCAAACATCAGTGGCACCAGATTTGTCACTTGATTATATAAATGTTACATTCTTGGACCTACAAGTTGAAATGAATAGGTTACAGGAGGCAATAAAAGTCTTAAATCATAGCTACATCAATCTCAAGGACATTGGTACATATGAATATTATGTAAAATGGCCTTGGTATGTATGGCTCTTAATCTGCCTTGCTGGTGTAGCTATGCTTGTTTTACTATTCTTCATATGCTGTTGTACAGGATGTGGGACTAGTTGTTTTAAGAAATGTGGTGGTTGTTGTGATGATTATACTGGATACCAGGAGTTAGTAATCAAAACTTCACATGACGAC
	            </sequences>
	            <feature>
		            <name>CDS</name>
		            <type>aminoAcid</type>
		            <coordinates>1-4083</coordinates>
	            </feature>
	            <feature>
		            <name>SigPep</name>
		            <type>aminoAcid</type>
		            <coordinates>1-39</coordinates>
	            </feature>
	            <feature>
		            <name>S1</name>
		            <type>aminoAcid</type>
		            <coordinates>40-2259</coordinates>
	            </feature>
	            <feature>
		            <name>S1A-siteB</name>
		            <type>aminoAcid</type>
		            <coordinates>238-285</coordinates>
	            </feature>
	            <feature>
		            <name>S1-epitope</name>
		            <type>aminoAcid</type>
		            <coordinates>298-582</coordinates>
	            </feature>
	            <feature>
		            <name>S1-nonepitope</name>
		            <type>aminoAcid</type>
		            <coordinates>40-237,286-297,583-2259</coordinates>
	            </feature>
	            <feature>
		            <name>S2</name>
		            <type>aminoAcid</type>
		            <coordinates>2260-4083</coordinates>
	            </feature>
           </genome>

            <population>
                <populationSize>10000</populationSize>
	            <inoculum>all</inoculum>
            </population>
		
		<populationType>staticPopulation</populationType>


	

            <fitnessFunction>
                <!-- Signal Peptide is under purifying selection. -->
                <purifyingFitness>
	                <feature>SigPep</feature>
                	<rank>
                		<order>chemical</order>
                		<breakTies>random</breakTies>
                	</rank>
                	<fitness>
                		<lowFitness>0.8</lowFitness>
		                <minimumFitness>0.7</minimumFitness>
                	</fitness>
                </purifyingFitness>
                
                <!-- Receptor-binding site is under strong purifying selection. -->
                <purifyingFitness>
	                <feature>S1A-siteB</feature>
                	<rank>
                		<order>chemical</order>
                		<breakTies>random</breakTies>
                		<probableSet>3</probableSet>
                	</rank>
                	<fitness>
                		<lowFitness>0.9</lowFitness>
		                <minimumFitness>0.1</minimumFitness>
                	</fitness>
                </purifyingFitness>

                <!-- Non-epitope sites in S1 are under weak purifying selection, but the preferred amino acid at each site can change slowly over time. -->                
                <purifyingFitness>
	                <feature>S1-nonepitope</feature>
                	<rank>
                		<order>chemical</order>
                		<breakTies>random</breakTies>
                		<probableSet>5</probableSet>
                	</rank>
                	<fitness>
                		<lowFitness>0.97</lowFitness>
		                <minimumFitness>0.9</minimumFitness>
                	</fitness>
                	<fluctuate>
                		<rate>0.00001</rate>
                		<fitnessLimit>0.97</fitnessLimit>
                	</fluctuate>
                </purifyingFitness>

                <!-- Epitope sites are also under purifying selection, and the preferred amino acid at each site can change slightly faster over time than at non-epitope sites. -->                
                <purifyingFitness>
	                <feature>S1-epitope</feature>
                	<rank>
                		<order>chemical</order>
                		<breakTies>random</breakTies>
                		<probableSet>5</probableSet>
                	</rank>
                	<fitness>
                		<lowFitness>0.95</lowFitness>
		                <minimumFitness>0.1</minimumFitness>
                	</fitness>
                	<fluctuate>
                		<rate>0.0001</rate>
                		<fitnessLimit>0.95</fitnessLimit>
                	</fluctuate>
                </purifyingFitness>
                                
                <!-- Epitope sites are also under exposure-dependent selection that allows for beneficial new mutations that can escape past immunity due to previous exposure. -->
                <exposureDependentFitness>
	                <feature>S1-epitope</feature>
                	<penalty>0.05</penalty>
                </exposureDependentFitness>
                
                <!-- S2 is under purifying selection. -->                
                <purifyingFitness>
	                <feature>S2</feature>
                	<rank>
                		<order>chemical</order>
                		<breakTies>random</breakTies>
                		<probableSet>5</probableSet>
                	</rank>
                	<fitness>
                		<lowFitness>0.8</lowFitness>
		                <minimumFitness>0.7</minimumFitness>
                	</fitness>
                	<fluctuate>
                		<rate>0.00001</rate>
                		<fitnessLimit>0.8</fitnessLimit>
                	</fluctuate>
                </purifyingFitness>
            </fitnessFunction>

	        <mutator>
	            <nucleotideMutator>
	                <mutationRate>2E-4</mutationRate>
	                <transitionBias>2.0</transitionBias>
	            </nucleotideMutator>
	        </mutator>

	        <replicator>
	            <recombinantReplicator>
					<dualInfectionProbability>0.01</dualInfectionProbability>
					<recombinationProbability>0.001</recombinationProbability>
				</recombinantReplicator>
	        </replicator>

            <epoch>
                <name>epoch1</name>
                <generationCount>500</generationCount>
            </epoch>

           
            <samplingSchedule>
                <sampler>
                    <atFrequency>50</atFrequency>
                    <fileName>data/simulated_oc43a_s14.fasta</fileName>
                    <alignment>
                    	<sampleSize>10</sampleSize>
	                    <format>FASTA</format>
                        <label>sample_%g_%s|%g|%f</label>
                    </alignment>
                </sampler>
            </samplingSchedule>
        </simulation>
</santa>
